# Файлы и системные вызовы (lab2)

## Теоретические вопросы
    1. Системные вызовы и механизм их работы.
    2. Что такое файл? Чем отличается файл от дирректории?
    3. Что такое inode и dentry? Их основные поля и зачем они нужны?
    4. Символьные и жесткие ссылки и инструменты для их создания (symlink(2) и link(2)).
    5. Что выводит утилита strace? Используйте её вместе с библиотекой для времени, объясните что происходит.
    6. Зачем нужно vdso?
    7. Что такое файловая система?
    8. Утилиты mount и unmount. Что они делают и зачем нужны?

## Задания (порядок выполнения не важен)
    1. Логгер:
        a. Реализуйте динамическую библиотеку логгера с указанным в файле pwd/src/include/config.h интерфейсом.
        Сообщение логгера должно иметь следующую сигнатуру: "TIME(UTC) FILE LINE [PID] | LEVEL: MESSAGE".
        При реализации учтите возможные способы передачи пути к дирректории с лог файлами (см. раздел "Команды для запуска
        и окружение"). Если путь к папке с логами не был передан ни одним из способов, то используйте stderr для вывода сообщений.

    2. Конфиг:
        a. Реализуйте статическую библиотеку системы конфигурации с указанным в файле pwd/src/include/config.h интерфейсом.
           При реализации учтите возможные способы передачи пути к файлу с конфигурацией (см. раздел "Команды для запуска
            и окружение"). Если путь к файлу с конфигурацией не был передан ни одним из способов, то ищите файл с
            конфигурацией в корневой дирректории проекта (он должен называться proxy.conf). Если по этому пути файла не оказалось,

            то используйте стандартные зангчения для необходимых переменных.
        b. Конфиг должен поддерживать параметры, указанные в разделе "Параметры конфигурации".
        c. Должна быть выстроена система приоритетов: Файл конфигурации < Переменная окружения < Опция командной.
           Значения параметров из источника с большим приоритетом перекрывают значения из источника с меньшим приоритетом.
        b. Используйте логгер для вывода сообщений об ошибках и трассировки

    3. Время
        a. Реализуйте статическую библиотеку для времени с указанным в файле pwd/src/include/my_time.h интерфейсом.
            Для этого используйте системный вызов time(2).
        b. Используйте получившуюся библиотечную функцию в логгере для получения времени.

    4. Версионирование библиотеки для времени
        a. Сохраните текущую версию библиотеки для времени и напишите новую реализацию, использующую свою обёртку над
            системным вызовом time (используйте syscall(2) из libc).
        b. Сделайте ещё одну реализацию этой библиотеки. Для этого разберитесь как работает syscall(2) и
            сделайте системный вызов без его помощи (используйте ассемблерные вставки).
        c. Для переключения между этими реализациями используйте символьные ссылки (.so файл библиотеки (с названием libtime.so)
            должен быть символьной ссылкой на одну из версий библиотеки).

    5. Модифицируйте систему загрузки плагинов из первой лабораторной так, чтобы она загружала плагины,
        названия которых ей переданы через конфигурацию или переменную окружения (см. раздел "Команды для запуска и окружение")

    6. Бэкап логов
        a. Напишите плагин, который будет создавать жесткие ссылки на лог файлы в резервной директории с названием log_backup
            (она должна быть расположена на том же уровне, что и основная дирректория с логами).


## Команды для запуска и окружение
    Источники значений для параметров конфигурации:

    Передача пути к файлу с конфигурацией возможна двумя способами:
        1. Через флаг -c при запуске. (--config)
        2. Через переменную окуржения CONFIG_PATH

    Передача пути к дирректории для логов возможна двумя способами:
        1. Через флаг -l при запуске. (--log_dir)
        2. Через переменную окуржения LOG_DIR_PATH

    Передача списка плагинов для загрузки возможна двумя способами:
        1. Через переменную plugins в файле конфигурации
        2. Через переменную окружения MASTER_PLUGINS (разделителем между названиями выступает запятая)

    Команда для запуска:
        pwd/install/proxy -c path_to_config_file -l path_to_log_dir

    Флаги командной строки могут идти в любом порядке и являются опциональными.
    Способы задания параметров конфигурации выстроены по убыванию приоритета. Так если параметр имеет два
    различных значения от разных источников, до браться будет значение с более высоким приоритетом.


## Конфигурационные параметры
    log_file_size_limit=1024 # Максимальный размер лог файла в Kb
    log_dir="logs" # Путь до директории с лог файлами от pwd
    plugins=["test", "task_manager"] # Список плагинов


## Интерфейс и струтура проекта

### Файл my_time.h

#### Функции:

| Название     | Описание                 | Аргументы | Возвращаемое значение                    |
| :----------- | :----------------------- | :-------- | :--------------------------------------- |
| **get_time** | Возвращает текущее время | **void**  | **time_t**, текущее время в UNIX формате |